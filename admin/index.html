<!DOCTYPE HTML>
<html>
  <head>
    <meta charset="UTF-8">
    <link href="/admin/adminStyle.css" rel="stylesheet" />
    <!-- <link href="/static/styles.css" rel="stylesheet" /> -->
    <link href="/static/prism.css" rel="stylesheet" />
  </head>

  <body>
    <script src="/admin/admin.js" type="text/javascript"></script>
    <script type="text/javascript">

function debounce(bounce, fn) {
  return (function() {
    let timeout;
    return function(...args) {
      if (timeout) {
        window.clearTimeout(timeout);
      }
      timeout = setTimeout(() => fn.apply(this, args), bounce);
    }
  })();
}

var app = Elm.Main.fullscreen();
const highlight = debounce(200, function() {
  Prism.highlightAll();
});

app.ports.highlight.subscribe(highlight);

app.ports.setupEdit.subscribe(function() {
  highlight();
  setTimeout(setupSyncScroll, 200);
});

function setupSyncScroll() {
  const edit = document.querySelector('.edit-post--markdown');
  const prev = document.querySelector('.edit-post--html');
  edit.addEventListener('scroll', syncScroll(edit, prev));
  syncScroll(edit, prev);
}

const syncScroll = (e1, e2) => ev => {
    const frac = e1.scrollTop / e1.scrollTopMax;
    e2.scrollTop = e2.scrollTopMax * frac;
}

    </script>
    <script src="/static/prism.js" type="text/javascript"></script>
  </body>
</html>
